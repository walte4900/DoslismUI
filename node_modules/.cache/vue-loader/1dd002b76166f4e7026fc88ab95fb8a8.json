{"remainingRequest":"F:\\doslism-ui\\doslism-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\doslism-ui\\doslism-ui\\src\\views\\Game.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\doslism-ui\\doslism-ui\\src\\views\\Game.vue","mtime":1610627862723},{"path":"F:\\doslism-ui\\doslism-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\doslism-ui\\doslism-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\doslism-ui\\doslism-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\doslism-ui\\doslism-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIOS4peagvOaooeW8jwoidXNlIHN0cmljdCI7Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gewogICAgY29uc3QgbWFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWQnKVswXTsKICAgIGNvbnN0IHNjb3JlRGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzY29yZScpWzBdOwogICAgY29uc3Qgc3RhcnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjc3RhcnQtYnRuJylbMF07CiAgICBjb25zdCBkaWZmaWN1bHR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2RpZmZpY3VsdHktc2VsZWN0b3InKVswXTsKICAgIGNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubWluaS1ncmlkIik7CiAgICBsZXQgd2lkdGggPSAxODsKICAgIGxldCBoZWlnaHQgPSAyODsKICAgIGxldCBzcXVhcmVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZCBkaXYnKSk7CiAgICBsZXQgb3ZlciA9IHRydWU7CiAgICBsZXQgdGltZXJJZCA9IG51bGw7CiAgICBsZXQgc2NvcmUgPSAwOwoKICAgIGxldCBzcGVlZCA9IDE7CgogICAgLy8g5a6a5LmJ5LiL6JC95pa55Z2X55qE5b2i54q2CiAgICBjb25zdCBMID0gWwogICAgICAgIFsxLCB3aWR0aCArIDEsIHdpZHRoICogMiArIDEsIDJdLAogICAgICAgIFt3aWR0aCwgd2lkdGggKyAxLCB3aWR0aCArIDIsIHdpZHRoICogMiArIDJdLAogICAgICAgIFsxLCB3aWR0aCArIDEsIHdpZHRoICogMiArIDEsIHdpZHRoICogMl0sCiAgICAgICAgW3dpZHRoLCB3aWR0aCAqIDIsIHdpZHRoICogMiArIDEsIHdpZHRoICogMiArIDJdCiAgICBdOwoKICAgIGNvbnN0IFogPSBbCiAgICAgICAgWzAsIHdpZHRoLCB3aWR0aCArIDEsIHdpZHRoICogMiArIDFdLAogICAgICAgIFt3aWR0aCArIDEsIHdpZHRoICsgMiwgd2lkdGggKiAyLCB3aWR0aCAqIDIgKyAxXSwKICAgICAgICBbMCwgd2lkdGgsIHdpZHRoICsgMSwgd2lkdGggKiAyICsgMV0sCiAgICAgICAgW3dpZHRoICsgMSwgd2lkdGggKyAyLCB3aWR0aCAqIDIsIHdpZHRoICogMiArIDFdCiAgICBdOwoKICAgIGNvbnN0IFQgPSBbCiAgICAgICAgWzEsIHdpZHRoLCB3aWR0aCArIDEsIHdpZHRoICsgMl0sCiAgICAgICAgWzEsIHdpZHRoICsgMSwgd2lkdGggKyAyLCB3aWR0aCAqIDIgKyAxXSwKICAgICAgICBbd2lkdGgsIHdpZHRoICsgMSwgd2lkdGggKyAyLCB3aWR0aCAqIDIgKyAxXSwKICAgICAgICBbMSwgd2lkdGgsIHdpZHRoICsgMSwgd2lkdGggKiAyICsgMV0KICAgIF07CgogICAgY29uc3QgTyA9IFsKICAgICAgICBbMCwgMSwgd2lkdGgsIHdpZHRoICsgMV0sCiAgICAgICAgWzAsIDEsIHdpZHRoLCB3aWR0aCArIDFdLAogICAgICAgIFswLCAxLCB3aWR0aCwgd2lkdGggKyAxXSwKICAgICAgICBbMCwgMSwgd2lkdGgsIHdpZHRoICsgMV0KICAgIF07CgogICAgY29uc3QgSSA9IFsKICAgICAgICBbMSwgd2lkdGggKyAxLCB3aWR0aCAqIDIgKyAxLCB3aWR0aCAqIDMgKyAxXSwKICAgICAgICBbd2lkdGgsIHdpZHRoICsgMSwgd2lkdGggKyAyLCB3aWR0aCArIDNdLAogICAgICAgIFsxLCB3aWR0aCArIDEsIHdpZHRoICogMiArIDEsIHdpZHRoICogMyArIDFdLAogICAgICAgIFt3aWR0aCwgd2lkdGggKyAxLCB3aWR0aCArIDIsIHdpZHRoICsgM10KICAgIF07CiAgICAvLyDmiYDmnInnmoTkuIvokL3mlrnlnZfpm4blkIgKICAgIGxldCBkcm9wcyA9IFtMLCBaLCBULCBPLCBJXTsKICAgIGNvbnN0IGRyb3BMZW5ndGggPSBkcm9wcy5sZW5ndGg7CgogICAgbGV0IGN1cnJlbnRQb3NpdGlvbiA9IDQ7CiAgICBsZXQgY3VycmVudFJvdGF0aW9uID0gMDsKCiAgICBsZXQgcmFuZG9tID0gMDsKICAgIGxldCBjdXJyZW50ID0gZHJvcHNbMF1bMF07CiAgICBjb25zdCBkaXNwbGF5U3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5taW5pLWdyaWQgZGl2Jyk7CiAgICBjb25zdCBkaXNwbGF5V2lkdGggPSA0OwogICAgbGV0IGRpc3BsYXlJbmRleCA9IDA7CiAgICBsZXQgbmV4dFJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHdpZHRoKTsKCiAgICBjb25zdCB1cENvbWluZyA9IFsKICAgICAgICBbMSwgZGlzcGxheVdpZHRoICsgMSwgZGlzcGxheVdpZHRoICogMiArIDEsIDJdLAogICAgICAgIFswLCBkaXNwbGF5V2lkdGgsIGRpc3BsYXlXaWR0aCArIDEsIGRpc3BsYXlXaWR0aCAqIDIgKyAxXSwKICAgICAgICBbMSwgZGlzcGxheVdpZHRoLCBkaXNwbGF5V2lkdGggKyAxLCBkaXNwbGF5V2lkdGggKyAyXSwKICAgICAgICBbMCwgMSwgZGlzcGxheVdpZHRoLCBkaXNwbGF5V2lkdGggKyAxXSwKICAgICAgICBbMSwgZGlzcGxheVdpZHRoICsgMSwgZGlzcGxheVdpZHRoICogMiArIDEsIGRpc3BsYXlXaWR0aCAqIDMgKyAxXQogICAgXTsKCgoKCiAgICAvKioKICAgICAqIOeUn+aIkOeUseWkmuS4quWNleWFg+agvOe7hOWQiOaIkOeahOefqeW9ouWcsOWbvgogICAgICogQHBhcmFtIHtudW1iZXJ9IHc6IOWcsOWbvuWuveW6pgogICAgICogQHBhcmFtIHtudW1iZXJ9IGgg5Zyw5Zu+6auY5bqmCiAgICAgKiBAcGFyYW0ge251bWJlcn0gZWRnZSDljZXlhYPmoLzovrnplb8KICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVNYXAodywgaCwgZWRnZSkgewogICAgICAgIGNvbnN0IGJsb2NrID0gYDxkaXYgc3R5bGU9IiI+PC9kaXY+YDsKICAgICAgICBjb25zdCBzdW0gPSB3ICogaDsKICAgICAgICBjb25zdCBncm91bmQgPSAyICogdzsKICAgICAgICBtYXAuc3R5bGUgPSBgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICAgICAgICAgICAgICAgICB3aWR0aDogJHt3ICogZWRnZX1weDsgaGVpZ2h0OiAke2ggKiBlZGdlfXB4OwogICAgICAgICAgICAgICAgICAgIGA7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdW07IGkrKykgewogICAgICAgICAgICBsZXQgYmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgYmxvY2suc2V0QXR0cmlidXRlKCdzdHlsZScsIGBoZWlnaHQ6JHtlZGdlfXB4O3dpZHRoOiR7ZWRnZX1weDtgKTsKICAgICAgICAgICAgaWYgKGkgJSB3aWR0aCA9PSB3aWR0aCAtIDEgfHwgaSAlIHdpZHRoID09IDApIHsgYmxvY2suY2xhc3NMaXN0LmFkZCgnd2FsbCcpOyB9CiAgICAgICAgICAgIHNxdWFyZXMucHVzaChibG9jayk7CiAgICAgICAgICAgIG1hcC5hcHBlbmRDaGlsZChibG9jayk7CiAgICAgICAgfTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VuZDsgaSsrKSB7CiAgICAgICAgICAgIGxldCBmbG9vciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBmbG9vci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYGhlaWdodDoke2VkZ2V9cHg7d2lkdGg6JHtlZGdlfXB4O2ApOwogICAgICAgICAgICBmbG9vci5jbGFzc0xpc3QuYWRkKCd0YWtlbicpOwogICAgICAgICAgICBzcXVhcmVzLnB1c2goZmxvb3IpOwogICAgICAgICAgICBtYXAuYXBwZW5kQ2hpbGQoZmxvb3IpOwoKICAgICAgICB9CgogICAgfQoKICAgIC8qKgogICAgICog57uY5Yi25LiL6JC95Z2XCiAgICAgKi8KICAgIGZ1bmN0aW9uIGRyYXcoKSB7CiAgICAgICAgY3VycmVudC5mb3JFYWNoKGluZGV4ID0+IHsKICAgICAgICAgICAgc3F1YXJlc1tjdXJyZW50UG9zaXRpb24gKyBpbmRleF0uY2xhc3NMaXN0LmFkZCgnZHJvcCcpOwogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICog5pOm6Zmk5LiL6JC95Z2XCiAgICAqLwogICAgZnVuY3Rpb24gdW5kcmF3KCkgewogICAgICAgIGN1cnJlbnQuZm9yRWFjaChpbmRleCA9PiB7CiAgICAgICAgICAgIHNxdWFyZXNbY3VycmVudFBvc2l0aW9uICsgaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3AnKTsKICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOenu+WKqOeisOWIsOWFtuWug+aWueWdl+aXtu+8jOS8muWBnOatouenu+WKqO+8jOW8gOWni+aWsOeahOaWueWdlwogICAgICovCiAgICBmdW5jdGlvbiBmcmVlemUoKSB7CiAgICAgICAgaWYgKGN1cnJlbnQuc29tZShpbmRleCA9PiBzcXVhcmVzW2N1cnJlbnRQb3NpdGlvbiArIGluZGV4ICsgd2lkdGhdLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkpIHsKICAgICAgICAgICAgY3VycmVudC5mb3JFYWNoKGluZGV4ID0+IHNxdWFyZXNbY3VycmVudFBvc2l0aW9uICsgaW5kZXhdLmNsYXNzTGlzdC5hZGQoJ3Rha2VuJykpOwogICAgICAgICAgICBjbGVhckxpbmUoKTsKICAgICAgICAgICAgLy8g6ZqP5py655Sf5oiQ5paw55qE5pa55Z2XCiAgICAgICAgICAgIHJhbmRvbSA9IG5leHRSYW5kb207CiAgICAgICAgICAgIG5leHRSYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBkcm9wTGVuZ3RoKTsKICAgICAgICAgICAgY3VycmVudCA9IGRyb3BzW3JhbmRvbV1bY3VycmVudFJvdGF0aW9uXTsKICAgICAgICAgICAgLy8g5LuO5Lit6Ze05L2N572u5Ye6546wCiAgICAgICAgICAgIGN1cnJlbnRQb3NpdGlvbiA9IDQ7CiAgICAgICAgICAgIGRyYXcoKTsKICAgICAgICAgICAgZGlzcGxheVNoYXBlKCk7CiAgICAgICAgICAgIGdhbWVPdmVyKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog56e75Yqo5LiL6JC95Z2XCiAgICAgKi8KICAgIGZ1bmN0aW9uIG1vdmVEb3duKCkgewogICAgICAgIHVuZHJhdygpOwogICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSB3aWR0aDsKICAgICAgICBkcmF3KCk7CiAgICAgICAgZnJlZXplKCk7CiAgICB9CgoKICAgIC8vIOiuvue9ruaWueWdl+i/kOWKqAogICAgZnVuY3Rpb24gbW92ZUxlZnQoKSB7CiAgICAgICAgdW5kcmF3KCk7CiAgICAgICAgY29uc3QgaXNBdExlZnRFZGdlID0gY3VycmVudC5zb21lKGluZGV4ID0+IChjdXJyZW50UG9zaXRpb24gKyBpbmRleCkgJSB3aWR0aCA9PSAxKTsKICAgICAgICBpZiAoIWlzQXRMZWZ0RWRnZSkgY3VycmVudFBvc2l0aW9uIC09IDE7CiAgICAgICAgaWYgKGN1cnJlbnQuc29tZShpbmRleCA9PiBzcXVhcmVzW2N1cnJlbnRQb3NpdGlvbiArIGluZGV4XS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rha2VuJykpKSB7CiAgICAgICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSAxOwogICAgICAgIH0KICAgICAgICBkcmF3KCk7CiAgICB9CgogICAgZnVuY3Rpb24gbW92ZVJpZ2h0KCkgewogICAgICAgIHVuZHJhdygpOwogICAgICAgIGNvbnN0IGlzQXRSaWdodEVkZ2UgPSBjdXJyZW50LnNvbWUoaW5kZXggPT4gKGN1cnJlbnRQb3NpdGlvbiArIGluZGV4KSAlIHdpZHRoID09ICh3aWR0aCAtIDIpKTsKICAgICAgICBpZiAoIWlzQXRSaWdodEVkZ2UpIGN1cnJlbnRQb3NpdGlvbiArPSAxOwogICAgICAgIGlmIChjdXJyZW50LnNvbWUoaW5kZXggPT4gc3F1YXJlc1tjdXJyZW50UG9zaXRpb24gKyBpbmRleF0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWtlbicpKSkgewogICAgICAgICAgICBjdXJyZW50UG9zaXRpb24gLT0gMTsKICAgICAgICB9CiAgICAgICAgZHJhdygpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJvdGF0ZSgpIHsKICAgICAgICB1bmRyYXcoKTsKICAgICAgICBsZXQgbmV3Um90YXRpb247CiAgICAgICAgaWYgKGN1cnJlbnRSb3RhdGlvbiArIDEgPT09IGN1cnJlbnQubGVuZ3RoKSB7CiAgICAgICAgICAgIG5ld1JvdGF0aW9uID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdSb3RhdGlvbiA9IGN1cnJlbnRSb3RhdGlvbiArIDE7CiAgICAgICAgfQogICAgICAgIGxldCBuZXdDdXJyID0gZHJvcHNbcmFuZG9tXVtuZXdSb3RhdGlvbl07CiAgICAgICAgaWYgKG5ld0N1cnIuc29tZShpbmRleCA9PiAoY3VycmVudFBvc2l0aW9uICsgaW5kZXgpICUgd2lkdGggPT0gMCkgfHwKICAgICAgICAgICAgbmV3Q3Vyci5zb21lKGluZGV4ID0+IChjdXJyZW50UG9zaXRpb24gKyBpbmRleCkgJSB3aWR0aCA9PSB3aWR0aCAtIDEpKSB7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3VycmVudFJvdGF0aW9uID0gbmV3Um90YXRpb247CiAgICAgICAgICAgIGN1cnJlbnQgPSBkcm9wc1tyYW5kb21dW2N1cnJlbnRSb3RhdGlvbl07CiAgICAgICAgfQoKICAgICAgICBkcmF3KCk7CiAgICB9CgoKCiAgICBmdW5jdGlvbiBkaXNwbGF5U2hhcGUoKSB7CiAgICAgICAgZGlzcGxheVNxdWFyZXMuZm9yRWFjaChzcXVhcmUgPT4gewogICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcCcpOwogICAgICAgIH0pOwogICAgICAgIHVwQ29taW5nW25leHRSYW5kb21dLmZvckVhY2goaW5kZXggPT4gewogICAgICAgICAgICBkaXNwbGF5U3F1YXJlc1tkaXNwbGF5SW5kZXggKyBpbmRleF0uY2xhc3NMaXN0LmFkZCgnZHJvcCcpOwogICAgICAgIH0pOwogICAgfQoKCgoKICAgIC8qKiDmtojpmaTmlrnlnZcgKi8KICAgIGZ1bmN0aW9uIGNsZWFyTGluZSgpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdpZHRoICogaGVpZ2h0IC0gMTsgaSsrKSB7CiAgICAgICAgICAgIGxldCBsaW5lID0gW107CiAgICAgICAgICAgIGlmIChpICUgd2lkdGggPT09IDApIHsKICAgICAgICAgICAgICAgIGxldCBzdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxpbmUgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgd2lkdGggLSAxOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBpICsgajsKICAgICAgICAgICAgICAgICAgICBsaW5lLnB1c2goaW5kZXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGluZS5mb3JFYWNoKGluZGV4ID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXNxdWFyZXNbaW5kZXhdLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIGxpbmUuZm9yRWFjaChpbmRleCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNxdWFyZXNbaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoJ3Rha2VuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNxdWFyZXNbaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3AnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzcXVhcmVzcmVtb3ZlZCA9IHNxdWFyZXMuc3BsaWNlKGksIHdpZHRoKTsKICAgICAgICAgICAgICAgICAgICBzcXVhcmVzID0gc3F1YXJlc3JlbW92ZWQuY29uY2F0KHNxdWFyZXMpOwogICAgICAgICAgICAgICAgICAgIHNxdWFyZXMuZm9yRWFjaChjZWxsID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgbWFwLmFwcGVuZENoaWxkKGNlbGwpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHNjb3JlICs9IDEwOwogICAgICAgICAgICAgICAgICAgIHNjb3JlRGlzcGxheS5pbm5lckhUTUwgPSAn5b2T5YmN5b6X5YiGOiAnICsgc2NvcmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8g6K6+572u6ZSu55uY5LqL5Lu2CiAgICBmdW5jdGlvbiBjb250cm9sKGUpIHsKICAgICAgICBpZiAoIW92ZXIpIHsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMzcgfHwgZS5rZXlDb2RlID09PSA2NSkgbW92ZUxlZnQoKTsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMzggfHwgZS5rZXlDb2RlID09PSA4Nykgcm90YXRlKCk7CiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDM5IHx8IGUua2V5Q29kZSA9PT0gNjgpIG1vdmVSaWdodCgpOwogICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA0MCB8fCBlLmtleUNvZGUgPT09IDgzKSBtb3ZlRG93bigpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOWHveaVsOiKgua1ge+8jOS9v+aTjeS9nOmikeeOh+WPr+iwgwogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g6ZyA6KaB6L+b6KGM6IqC5rWB55qE5Ye95pWwCiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2FpdCDmnIDnn63mk43kvZzpl7TpmpQKICAgICAqLwogICAgZnVuY3Rpb24gdGhyb3R0bGUoZm4sIHdhaXQgPSAxMDApIHsKICAgICAgICBsZXQgbGFzdFRpbWUsIHRpbWVJZDsKICAgICAgICAvLyDlj4LmlbDmjIflkJHov5nkuKrlh73mlbDmnKzouqsKICAgICAgICBjb25zb2xlLmxvZyhhcmd1bWVudHMpOwogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIOaMh+WQkeiwg+eUqOWbnuiwg+WHveaVsOeahOWvueixoe+8jOWQpuWImWZu55qEdGhpc+S8muaMh+WQkXdpbmRvdwogICAgICAgICAgICBsZXQgY29udGV4dCA9IHRoaXM7CiAgICAgICAgICAgIGxldCBjdXJyZW50VGltZSA9ICtuZXcgRGF0ZTsKICAgICAgICAgICAgLy8g5Y+C5pWw5oyH5ZCR6LCD55So6ICF55qE5Y+C5pWwZXZlbnQKICAgICAgICAgICAgbGV0IGFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICAgIGlmIChsYXN0VGltZSAmJiBjdXJyZW50VGltZSA8IGxhc3RUaW1lICsgd2FpdCkgewogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVJZCkKICAgICAgICAgICAgICAgIC8vIOWumuaXtuWZqOWGheWumuS5ieeahOWHveaVsO+8jOWFtuS4rXRoaXPmjIflkJF3aW5kb3cKICAgICAgICAgICAgICAgIHRpbWVJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGxhc3RUaW1lID0gY3VycmVudFRpbWUKICAgICAgICAgICAgICAgICAgICAvLyDmlLnlj5h0aGlz5oyH5ZCR77yM6LWL5YC86LCD55So6ICF5Y+C5pWw57uZ5Ye95pWwCiAgICAgICAgICAgICAgICAgICAgZm4uYXBwbHkoY29udGV4dCwgYXJncykKICAgICAgICAgICAgICAgIH0sIHdhaXQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGFzdFRpbWUgPSBjdXJyZW50VGltZQogICAgICAgICAgICAgICAgZm4uYXBwbHkoY29udGV4dCwgYXJncykKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICog5ri45oiP57uT5p2fIEdhbWVPdmVyCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdhbWVPdmVyKCkgewogICAgICAgIGlmIChjdXJyZW50LnNvbWUoaW5kZXggPT4gc3F1YXJlc1tjdXJyZW50UG9zaXRpb24gKyBpbmRleF0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWtlbicpKSkgewogICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVySWQpOwogICAgICAgICAgICB0aW1lcklkID0gbnVsbDsKICAgICAgICAgICAgbWFwLmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBzY29yZURpc3BsYXkuaW5uZXJIVE1MID0gJ+WkquiPnOS6huWQp++8gSc7CiAgICAgICAgICAgIHNxdWFyZXMgPSBbXTsKICAgICAgICAgICAgc2NvcmUgPSAwOwogICAgICAgICAgICBnZW5lcmF0ZU1hcCh3aWR0aCwgaGVpZ2h0LCAyMik7CiAgICAgICAgICAgIG92ZXIgPSB0cnVlOwogICAgICAgICAgICBzdGFydEJ0bi5pbm5lclRleHQgPSAi5byA5aeLIjsKICAgICAgICB9CiAgICB9CgoKCiAgICAvLyDlvIDlp4vvvIzmmoLlgZzmjInpkq4KICAgIHN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIG92ZXIgPSBmYWxzZTsKICAgICAgICBzcGVlZCA9IE51bWJlcihkaWZmaWN1bHR5LnZhbHVlKTsKICAgICAgICBwcmV2aWV3LnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ2ZsZXgnKTsKICAgICAgICBpZiAodGltZXJJZCkgewogICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVySWQpOwogICAgICAgICAgICB0aW1lcklkID0gbnVsbDsKICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRocm90dGxlKGNvbnRyb2wsIDUwKSk7CiAgICAgICAgICAgIHN0YXJ0QnRuLmlubmVyVGV4dCA9ICLlvIDlp4siOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChtYXAuY2hpbGRyZW4ubGVuZ3RoID09IDApIGdlbmVyYXRlTWFwKHdpZHRoLCBoZWlnaHQsIDIyKTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRocm90dGxlKGNvbnRyb2wsIDUwKSk7CiAgICAgICAgICAgIGRyYXcoKTsKICAgICAgICAgICAgdGltZXJJZCA9IHNldEludGVydmFsKG1vdmVEb3duLCAxMDAwIC8gc3BlZWQpOwogICAgICAgICAgICBuZXh0UmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZHJvcExlbmd0aCk7CiAgICAgICAgICAgIGRpc3BsYXlTaGFwZSgpOwogICAgICAgICAgICBzdGFydEJ0bi5pbm5lclRleHQgPSAi5pqC5YGcIjsKICAgICAgICB9CiAgICB9KTsKCn0pOwpleHBvcnQgZGVmYXVsdCB7Cn0K"},{"version":3,"sources":["Game.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Game.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"game\">\n    <h3 id='score'>当前得分: 0</h3>\n    <select id='difficulty-selector'>\n        <option value=\"1\">新手</option>\n        <option value=\"3\">学徒</option>\n        <option value=\"5\">专家</option>\n        <option value=\"7\">大师</option>\n        <option value=\"10\">传奇</option>\n    </select>\n    <button id='start-btn'>开始</button>\n    <div class=\"container\">\n        <div class='grid'>\n        </div>\n        <div class=\"mini-grid\">\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n        </div>\n    </div>\n  </div>\n</template>\n<script>\n// 严格模式\n\"use strict\";\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const map = document.querySelectorAll('.grid')[0];\n    const scoreDisplay = document.querySelectorAll('#score')[0];\n    const startBtn = document.querySelectorAll('#start-btn')[0];\n    const difficulty = document.querySelectorAll('#difficulty-selector')[0];\n    const preview = document.querySelector(\".mini-grid\");\n    let width = 18;\n    let height = 28;\n    let squares = Array.from(document.querySelectorAll('.grid div'));\n    let over = true;\n    let timerId = null;\n    let score = 0;\n\n    let speed = 1;\n\n    // 定义下落方块的形状\n    const L = [\n        [1, width + 1, width * 2 + 1, 2],\n        [width, width + 1, width + 2, width * 2 + 2],\n        [1, width + 1, width * 2 + 1, width * 2],\n        [width, width * 2, width * 2 + 1, width * 2 + 2]\n    ];\n\n    const Z = [\n        [0, width, width + 1, width * 2 + 1],\n        [width + 1, width + 2, width * 2, width * 2 + 1],\n        [0, width, width + 1, width * 2 + 1],\n        [width + 1, width + 2, width * 2, width * 2 + 1]\n    ];\n\n    const T = [\n        [1, width, width + 1, width + 2],\n        [1, width + 1, width + 2, width * 2 + 1],\n        [width, width + 1, width + 2, width * 2 + 1],\n        [1, width, width + 1, width * 2 + 1]\n    ];\n\n    const O = [\n        [0, 1, width, width + 1],\n        [0, 1, width, width + 1],\n        [0, 1, width, width + 1],\n        [0, 1, width, width + 1]\n    ];\n\n    const I = [\n        [1, width + 1, width * 2 + 1, width * 3 + 1],\n        [width, width + 1, width + 2, width + 3],\n        [1, width + 1, width * 2 + 1, width * 3 + 1],\n        [width, width + 1, width + 2, width + 3]\n    ];\n    // 所有的下落方块集合\n    let drops = [L, Z, T, O, I];\n    const dropLength = drops.length;\n\n    let currentPosition = 4;\n    let currentRotation = 0;\n\n    let random = 0;\n    let current = drops[0][0];\n    const displaySquares = document.querySelectorAll('.mini-grid div');\n    const displayWidth = 4;\n    let displayIndex = 0;\n    let nextRandom = Math.floor(Math.random() * width);\n\n    const upComing = [\n        [1, displayWidth + 1, displayWidth * 2 + 1, 2],\n        [0, displayWidth, displayWidth + 1, displayWidth * 2 + 1],\n        [1, displayWidth, displayWidth + 1, displayWidth + 2],\n        [0, 1, displayWidth, displayWidth + 1],\n        [1, displayWidth + 1, displayWidth * 2 + 1, displayWidth * 3 + 1]\n    ];\n\n\n\n\n    /**\n     * 生成由多个单元格组合成的矩形地图\n     * @param {number} w: 地图宽度\n     * @param {number} h 地图高度\n     * @param {number} edge 单元格边长\n     */\n    function generateMap(w, h, edge) {\n        const block = `<div style=\"\"></div>`;\n        const sum = w * h;\n        const ground = 2 * w;\n        map.style = `display: flex;\n                     flex-wrap: wrap;\n                     width: ${w * edge}px; height: ${h * edge}px;\n                    `;\n        for (let i = 0; i < sum; i++) {\n            let block = document.createElement('div');\n            block.setAttribute('style', `height:${edge}px;width:${edge}px;`);\n            if (i % width == width - 1 || i % width == 0) { block.classList.add('wall'); }\n            squares.push(block);\n            map.appendChild(block);\n        };\n        for (let i = 0; i < ground; i++) {\n            let floor = document.createElement('div');\n            floor.setAttribute('style', `height:${edge}px;width:${edge}px;`);\n            floor.classList.add('taken');\n            squares.push(floor);\n            map.appendChild(floor);\n\n        }\n\n    }\n\n    /**\n     * 绘制下落块\n     */\n    function draw() {\n        current.forEach(index => {\n            squares[currentPosition + index].classList.add('drop');\n        });\n    }\n\n    /**\n     * 擦除下落块\n    */\n    function undraw() {\n        current.forEach(index => {\n            squares[currentPosition + index].classList.remove('drop');\n        });\n    }\n\n    /**\n     * 移动碰到其它方块时，会停止移动，开始新的方块\n     */\n    function freeze() {\n        if (current.some(index => squares[currentPosition + index + width].classList.contains('taken'))) {\n            current.forEach(index => squares[currentPosition + index].classList.add('taken'));\n            clearLine();\n            // 随机生成新的方块\n            random = nextRandom;\n            nextRandom = Math.floor(Math.random() * dropLength);\n            current = drops[random][currentRotation];\n            // 从中间位置出现\n            currentPosition = 4;\n            draw();\n            displayShape();\n            gameOver();\n        }\n    }\n\n    /**\n     * 移动下落块\n     */\n    function moveDown() {\n        undraw();\n        currentPosition += width;\n        draw();\n        freeze();\n    }\n\n\n    // 设置方块运动\n    function moveLeft() {\n        undraw();\n        const isAtLeftEdge = current.some(index => (currentPosition + index) % width == 1);\n        if (!isAtLeftEdge) currentPosition -= 1;\n        if (current.some(index => squares[currentPosition + index].classList.contains('taken'))) {\n            currentPosition += 1;\n        }\n        draw();\n    }\n\n    function moveRight() {\n        undraw();\n        const isAtRightEdge = current.some(index => (currentPosition + index) % width == (width - 2));\n        if (!isAtRightEdge) currentPosition += 1;\n        if (current.some(index => squares[currentPosition + index].classList.contains('taken'))) {\n            currentPosition -= 1;\n        }\n        draw();\n    }\n\n    function rotate() {\n        undraw();\n        let newRotation;\n        if (currentRotation + 1 === current.length) {\n            newRotation = 0;\n        } else {\n            newRotation = currentRotation + 1;\n        }\n        let newCurr = drops[random][newRotation];\n        if (newCurr.some(index => (currentPosition + index) % width == 0) ||\n            newCurr.some(index => (currentPosition + index) % width == width - 1)) {\n        } else {\n            currentRotation = newRotation;\n            current = drops[random][currentRotation];\n        }\n\n        draw();\n    }\n\n\n\n    function displayShape() {\n        displaySquares.forEach(square => {\n            square.classList.remove('drop');\n        });\n        upComing[nextRandom].forEach(index => {\n            displaySquares[displayIndex + index].classList.add('drop');\n        });\n    }\n\n\n\n\n    /** 消除方块 */\n    function clearLine() {\n        for (let i = 0; i < width * height - 1; i++) {\n            let line = [];\n            if (i % width === 0) {\n                let success = true;\n                line = [];\n                for (let j = 1; j < width - 1; j++) {\n                    let index = i + j;\n                    line.push(index);\n                }\n                line.forEach(index => {\n                    if (!squares[index].classList.contains('taken')) {\n                        success = false;\n                    }\n                });\n                if (success) {\n                    line.forEach(index => {\n                        squares[index].classList.remove('taken');\n                        squares[index].classList.remove('drop');\n                    });\n                    const squaresremoved = squares.splice(i, width);\n                    squares = squaresremoved.concat(squares);\n                    squares.forEach(cell => {\n                        map.appendChild(cell);\n                    });\n                    score += 10;\n                    scoreDisplay.innerHTML = '当前得分: ' + score;\n                }\n            }\n        }\n    }\n\n    // 设置键盘事件\n    function control(e) {\n        if (!over) {\n            if (e.keyCode === 37 || e.keyCode === 65) moveLeft();\n            if (e.keyCode === 38 || e.keyCode === 87) rotate();\n            if (e.keyCode === 39 || e.keyCode === 68) moveRight();\n            if (e.keyCode === 40 || e.keyCode === 83) moveDown();\n        }\n    }\n\n    /**\n     * 函数节流，使操作频率可调\n     * @param {Function} fn 需要进行节流的函数\n     * @param {number} wait 最短操作间隔\n     */\n    function throttle(fn, wait = 100) {\n        let lastTime, timeId;\n        // 参数指向这个函数本身\n        console.log(arguments);\n        return function () {\n            // 指向调用回调函数的对象，否则fn的this会指向window\n            let context = this;\n            let currentTime = +new Date;\n            // 参数指向调用者的参数event\n            let args = arguments;\n            if (lastTime && currentTime < lastTime + wait) {\n                clearTimeout(timeId)\n                // 定时器内定义的函数，其中this指向window\n                timeId = setTimeout(function () {\n                    lastTime = currentTime\n                    // 改变this指向，赋值调用者参数给函数\n                    fn.apply(context, args)\n                }, wait);\n            } else {\n                lastTime = currentTime\n                fn.apply(context, args)\n            }\n        }\n    }\n    /**\n     * 游戏结束 GameOver\n     */\n    function gameOver() {\n        if (current.some(index => squares[currentPosition + index].classList.contains('taken'))) {\n            clearInterval(timerId);\n            timerId = null;\n            map.innerHTML = '';\n            scoreDisplay.innerHTML = '太菜了吧！';\n            squares = [];\n            score = 0;\n            generateMap(width, height, 22);\n            over = true;\n            startBtn.innerText = \"开始\";\n        }\n    }\n\n\n\n    // 开始，暂停按钮\n    startBtn.addEventListener('click', () => {\n        over = false;\n        speed = Number(difficulty.value);\n        preview.style.setProperty('display', 'flex');\n        if (timerId) {\n            clearInterval(timerId);\n            timerId = null;\n            document.removeEventListener('keydown', throttle(control, 50));\n            startBtn.innerText = \"开始\";\n        } else {\n            if (map.children.length == 0) generateMap(width, height, 22);\n            document.addEventListener('keydown', throttle(control, 50));\n            draw();\n            timerId = setInterval(moveDown, 1000 / speed);\n            nextRandom = Math.floor(Math.random() * dropLength);\n            displayShape();\n            startBtn.innerText = \"暂停\";\n        }\n    });\n\n});\nexport default {\n}\n</script>\n<style lang=\"scss\" scoped>\n  #game{\n    margin: 0 auto;\n    width: 100px;\n}\n.container{\n    display: flex;\n    min-width: 500px;\n}\n\n.grid{\n    background: yellow;\n\n}\n\n.grid div{\n    margin: 0 auto;\n}\n\n\n.grid .wall{\n    background-color: black;\n}\n\n.grid .drop{\n    background: rgb(0, 0, 37);\n}\n\n.mini-grid .drop{\n    background: rgb(237, 237, 240);\n}\n\n.grid .taken{\n    background: rgb(8, 68, 58);\n}\n\n\n.mini-grid{\n    width: 80px;\n    height: 80px;\n    display: flex;\n    flex-wrap: wrap;\n    background: rgb(163, 157, 145);\n    display: none;\n}\n\n.mini-grid div{\n    height: 22px;\n    width: 22px;\n}\n\n</style>"]}]}